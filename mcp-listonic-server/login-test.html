<!DOCTYPE html>
<html>
<head>
    <title>Listonic Login Test</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>Test Listonic Login</h1>
    <p>Open DevTools Network tab to see the requests</p>
    
    <form id="loginForm">
        <input type="email" id="email" placeholder="Email" value="mateuszsych@gmail.com"><br>
        <input type="password" id="password" placeholder="Password" value="Ftorek12!!"><br>
        <button type="submit">Login</button>
    </form>
    
    <div id="result"></div>

    <script>
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const resultDiv = document.getElementById('result');
        
        resultDiv.innerHTML = 'Logging in...';
        
        try {
            // Try the exact same request as the Chrome extension
            const params = new URLSearchParams({
                provider: 'password',
                autoMerge: '1',
                autoDestruct: '1'
            });
            
            const response = await fetch(`https://api.listonic.com/api/loginextended?${params}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'Accept': 'application/json',
                    'clientauthorization': 'Bearer bGlzdG9uaWN2MjpmamRmc29qOTg3NGpkZmhqa2gzNGpraGZmZGZmZg=='
                },
                body: new URLSearchParams({
                    'username': email,
                    'password': password,
                    'client_id': 'listonicv2',
                    'redirect_uri': 'https://app.listonic.com/',
                    'client_secret': 'fjdfsoj9874jdfhjk'
                })
            });
            
            const text = await response.text();
            console.log('Response:', text);
            console.log('Status:', response.status);
            console.log('Headers:', Object.fromEntries(response.headers.entries()));
            
            resultDiv.innerHTML = `<pre>Status: ${response.status}\n\nResponse: ${text}</pre>`;
            
        } catch (error) {
            resultDiv.innerHTML = `<pre>Error: ${error.message}</pre>`;
        }
    });
    </script>
</body>
</html>